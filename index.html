<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Element Name Generator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="style.css" rel="stylesheet">
</head>
<body>

<div class="container py-4">
  <h1 class="text-center mb-3">Element Name Generator</h1>
  <p class="text-center">Enter a word to see how it spells out using periodic elements!</p>

  <div class="row justify-content-center mb-4">
    <div class="col-md-6">
      <div class="input-group">
        <input type="text" class="form-control" id="wordInput" placeholder="Enter a word">
        <button class="btn btn-primary" onclick="generate()">Generate</button>
      </div>
    </div>
  </div>
<div class="text-center mb-4">
  <button class="btn btn-outline-secondary" onclick="toggleDarkMode()">Toggle Dark Mode</button>
</div>
  <div id="result"></div>
</div>

<script>
  let official = {};
  let nonofficial = {};
  const chime = new Audio("sound1.wav");

function playSound() {
  chime.currentTime = 0; // rewind if user clicks fast
  chime.play();
}

  async function generate() {
    if (Object.keys(official).length === 0 || Object.keys(nonofficial).length === 0) {
      const res = await fetch('official.json');
      official = await res.json();
      const fallbackRes = await fetch('nonofficial.json');
      nonofficial = await fallbackRes.json();
    }

    const word = document.getElementById("wordInput").value.toLowerCase();
    const result = document.getElementById("result");
    result.innerHTML = "";
    playSound();

    const allPaths = [];

    function backtrack(index, path) {
      if (index === word.length) {
        allPaths.push([...path]);
        return;
      }

      let found = false;

      // Try 2-letter official match
      if (index + 1 < word.length) {
        const two = word[index] + word[index + 1];
        const sym2 = two[0].toUpperCase() + two[1].toLowerCase();
        if (official[sym2]) {
          path.push({ symbol: sym2, ...official[sym2] });
          backtrack(index + 2, path);
          path.pop();
          found = true;
        }
      }

      // Try 1-letter official match
      const one = word[index].toUpperCase();
      if (official[one]) {
        path.push({ symbol: one, ...official[one] });
        backtrack(index + 1, path);
        path.pop();
        found = true;
      }

      // Use non-official fallback (guaranteed match)
      if (!found) {
        const lower = word[index];
        const fallback = nonofficial[lower];
        path.push({
          symbol: fallback.symbol.toUpperCase(),
          number: fallback.number,
          name: fallback.name,
          fake: true
        });
        backtrack(index + 1, path);
        path.pop();
      }
    }

    backtrack(0, []);

    if (allPaths.length > 1) {
      const msg = document.createElement("p");
      msg.className = "text-center fw-semibold text-info";
      msg.textContent = "Looks like there are multiple ways to spell this!";
      result.appendChild(msg);
    }

    allPaths.forEach((path, index) => {
      if (allPaths.length > 1) {
        const optionLabel = document.createElement("p");
        optionLabel.className = "text-center fw-bold text-primary mt-4";
        optionLabel.textContent = `Option ${index + 1}`;
        result.appendChild(optionLabel);
      }

      const row = document.createElement("div");
      row.className = "d-flex flex-wrap justify-content-center gap-2 mb-3 fade-in";
      row.style.setProperty('--delay', `${index * 0.3}s`);

      path.forEach(p => {
        const box = document.createElement("div");
        box.className = "box" + (p.fake ? " fake" : "");

        const top = document.createElement("div");
        top.className = "top";
        top.textContent = p.number || "";

        const middle = document.createElement("div");
        middle.className = "middle";
        middle.textContent = p.symbol[0].toUpperCase() + p.symbol.slice(1).toLowerCase();

        const bottom = document.createElement("div");
        bottom.className = "bottom";
        bottom.textContent = p.name || "";

        box.appendChild(top);
        box.appendChild(middle);
        box.appendChild(bottom);
        row.appendChild(box);
      });

      result.appendChild(row);
    });
  document.getElementById("wordInput").addEventListener("keydown", function(e) {
  if (e.key === "Enter") {
    generate();
  }
  });
    
  }
  function toggleDarkMode() {
    document.body.classList.toggle("dark-mode");
  }
</script>

</body>
</html>
